# Publish Tutorial Narrative
# Demonstrates: Content generation with critique/refinement, selection, bot publishing

[narrative]
name = "publish_tutorial"
description = "Generate, select, and publish getting started tutorial to Discord"
skip_content_generation = true
model = "gemini-2.5-flash"

[toc]
order = ["generate_content", "select_best", "publish_message"]

# Define nested narrative for content generation
[narratives.generate_content]
narrative = "tutorial_content_generation"

# Define bot command for publishing
[bots.publish_message]
platform = "discord"
command = "messages.send"
guild_id = "1439415903753076859"
channel_id = "1441256008092483724"  # Update with tutorials channel ID
content = "{{select_best}}"

# Define table reference for loading generated tutorials
[tables.tutorial_content]
table_name = "tutorial_content"
limit = 100
format = "markdown"

[acts]
# Act 1: Run tutorial content generation to populate the table
generate_content = ["narratives.generate_content"]

# Act 2: Select the best tutorial from generated options
select_best = [
  "tables.tutorial_content",
  """You are reviewing tutorial options for the Botticelli Discord server.

Review all tutorials above and:
1. Evaluate them based on learning progression, code quality, clarity, completeness, and practicality
2. Select the SINGLE BEST tutorial that will get new users productive quickly
3. Output ONLY the selected tutorial content (no explanation, no prefix)""",
]

# Act 3: Publish to Discord tutorials channel (uses output from select_best)
publish_message = ["bots.publish_message"]
